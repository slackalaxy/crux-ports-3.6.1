# Description: Lightweight video thumbnailer that can be used by file managers.
# URL: https://github.com/dirkvdb/ffmpegthumbnailer
# Maintainer: Petar Petrov, slackalaxy at gmail dot com
# Depends on: ffmpeg libjpeg-turbo libpng gvfs gst-libav

name=ffmpegthumbnailer
version=2.2.2
release=2
source=(https://github.com/dirkvdb/$name/archive/$version.tar.gz
	efb5b618.patch
	ffmpegthumbnailer-ffmpeg5.patch)

build() {

	# Taken from Arch
	patch -d $name-$version -p1 < $SRC/ffmpegthumbnailer-ffmpeg5.patch # Fix build with FFmpeg 5
	patch -d $name-$version -p1 < $SRC/efb5b618.patch # Fix build with FFmpeg 5
	
	cd $name-$version
	mkdir -p build
	cd build
	cmake \
	-DCMAKE_BUILD_TYPE=Release \
	-DCMAKE_INSTALL_PREFIX=/usr \
	-DCMAKE_INSTALL_LIBDIR=lib \
	-DENABLE_GIO=ON \
	-DENABLE_THUMBNAILER=ON ..

	make
	make DESTDIR=$PKG install
}
